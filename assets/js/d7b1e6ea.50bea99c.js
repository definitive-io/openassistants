"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[586],{7998:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var n=s(5893),i=s(1151);const o={sidebar_position:3},r="Query functions",a={id:"query-functions",title:"Query functions",description:"One of the key ideas in OpenAssistants is the ability to dynamically populate the chat context with dynamic information.",source:"@site/docs/query-functions.md",sourceDirName:".",slug:"/query-functions",permalink:"/openassistants/docs/query-functions",draft:!1,unlisted:!1,editUrl:"https://github.com/definitive-io/openassistants/docs/query-functions.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Live demo",permalink:"/openassistants/docs/live-demo"},next:{title:"Extending OpenAssistants",permalink:"/openassistants/docs/category/extending-openassistants"}},c={},d=[];function l(e){const t={code:"code",h1:"h1",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"query-functions",children:"Query functions"}),"\n",(0,n.jsx)(t.p,{children:"One of the key ideas in OpenAssistants is the ability to dynamically populate the chat context with dynamic information."}),"\n",(0,n.jsxs)(t.p,{children:["One of the ways in which we support that is through the integrated SQL functions, such as the ",(0,n.jsx)(t.code,{children:"DuckDBQueryFunction"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["Here's an example YAML that uses the ",(0,n.jsx)(t.code,{children:"DuckDBQueryFunction"})," to pull in data from multiple CSV files that are part of our application."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:'name: show_recent_purchases\ndisplay_name: Show recent purchases\ndescription: |\n  Show a list of recent purchases (i.e. "Show recent Tesla purchases")\nsample_questions:\n  - Show recent Tesla purchases\nparameters:\n  json_schema:\n    type: object\n    properties:\n      product:\n        type: string\n        format: STRING\n        description: product name\n    required:\n      - product\ntype: DuckDBQueryFunction\ndataset: \'dummy-data/\'\nsqls:\n  - |\n    SELECT purchases.id, purchases.product, employees.email\n    FROM "purchases.csv"\n    INNER JOIN "employees.csv" ON purchases.employee = employees.id\n    WHERE lower(purchases.product) = lower(:product)\n    ORDER BY purchases.id DESC\n    LIMIT 5\nvisualizations: []\nsummarization: \'Describe these purchases\'\nsuggested_follow_ups:\n  - title: Show spend per product\n    prompt: Show spend per product\n'})}),"\n",(0,n.jsx)(t.p,{children:"The information produced by these queries is part of the conversation after use and can be used by the LLM to call other functions. Key components:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"description"})," field is used by the LLM to semantically map user prompts to the function. A good description should resemble the ways in which the function would expect to be invoked via a prompt. If the query is parameterized, it may also be effective to include sample prompts with real parameters in the description."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"parameters"})," field describes any parameters used in the query."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"type"})," is the specific function class this function instance should call."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"dataset"})," is the location of the data."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"sqls"})," is a list of SQL queries that should be executed on function call. Note that the specific syntax differs depending on the specific function class (i.e. DuckDB vs BigQuery). It is also good practice to make any filtering on parameters flexible (for example, case independent), because incorrectly mapped parameters can result in empty or incorrect data returned."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"visualizations"})," field takes in a list of python visualizations functions to add charts to your output."]}),"\n",(0,n.jsxs)(t.li,{children:["The ",(0,n.jsx)(t.code,{children:"summarization"})," field gives additional instructions to the LLM on how to summarize the data in the output."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"suggested_follow_ups"})," is a list of recommended prompts that would appear following the LLM response (",(0,n.jsx)(t.code,{children:"title"})," is what the user sees and ",(0,n.jsx)(t.code,{children:"prompt"})," is the prompt that is sent to the LLM). Suggested follow-ups are useful for directing the user along an optimal path in their chat. It is good practice to write the follow-up prompt as closely to the desired function description as you can to ensure that the LLM maps to the correct function"]}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},1151:(e,t,s)=>{s.d(t,{Z:()=>a,a:()=>r});var n=s(7294);const i={},o=n.createContext(i);function r(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);